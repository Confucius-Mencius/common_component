#ifndef DB_ENGINE_SRC_MONGODB_ENGINE2_H_
#define DB_ENGINE_SRC_MONGODB_ENGINE2_H_

#include "bson.h"
#include "bcon.h"
#include "mongoc.h"

class LbsProxySession
{
public:
	LbsProxySession();
	virtual ~LbsProxySession();

    bool Init(const loss::CJsonObject& conf);
    bool InsertDoc(const char*db, const char*tb, const bson_t *doc);
    bool SearchDocs(const char*db, const char*tb,
                                     const bson_t *cond, mongoc_cursor_t *&cursor, unsigned int skip,
                                     unsigned int limit, unsigned int batch_size,
                                     const bson_t *fields);
    bool UpdateDoc(const char*db, const char*coll,
                                    const bson_t *cond, const bson_t *updatedoc);
    bool UpsertDoc(const char*db, const char*coll,
                                    const bson_t *cond, const bson_t *updatedoc);
    bool DeleteDocOnce(const char*db, const char*coll,
                                        const bson_t *cond);
    bool DeleteDocAll(const char*db, const char*coll,
                                       const bson_t *cond);
    bool Count(const char*db, const char*coll, const bson_t *cond,
                                long long &count);
    bool Command(const char*db, const char*coll,
                                  const bson_t *command, bson_t &reply);
    int InsertDoc(const char*db, const char*tb,
                                   const loss::CJsonObject &insertdObj);
    int SearchDocs(const char*db, const char*tb,
                                    const loss::CJsonObject &condObj,
                                    std::vector<loss::CJsonObject> &replyObjs,
                                    const loss::CJsonObject &fieldsObj, unsigned int skip,
                                    unsigned int limit, unsigned int batch_size);
    int UpdateDoc(const char*db, const char*tb,
                                   const loss::CJsonObject &condObj,
                                   const loss::CJsonObject &updatedObj);
    int UpsertDoc(const char*db, const char* tb,
                                   const loss::CJsonObject &condObj,
                                   const loss::CJsonObject &updatedObj);
    int DeleteDocOnce(const char*db, const char*tb,
                                       const loss::CJsonObject &condObj);
    int DeleteDocAll(const char*db, const char*tb,
                                      const loss::CJsonObject &condObj);
    int Count(const char*db, const char*tb,
                               const loss::CJsonObject &condObj, long long &count);
    int Command(const char*db, const char*tb,
                                 const loss::CJsonObject &commandObj,
                                 loss::CJsonObject &replyObj);
    
private:

};


#endif // DB_ENGINE_SRC_MONGODB_ENGINE2_H_
